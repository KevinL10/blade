
from pydantic import BaseModel, Field
from typing import List

class Vulnerability(BaseModel):
    type: str = Field(..., description="The type of security vulnerability.")
    description: str =  Field(..., description="A short description of the context and vulnerable parameters.")
    code: str = Field(..., description="The surrounding code context of up to 3 lines that contains the vulnerability.")

class VulnerabilityReport(BaseModel):
    vulnerabilities: List[Vulnerability] = Field(..., description="A list of discovered security vulnerabilities.")

analysis_function = {
    "name": "analyze_vulnerabilities", 
    "description": "Analyze the code and return a list of any critical security vulnerabilities that are found.",
    "parameters": VulnerabilityReport.model_json_schema()
}